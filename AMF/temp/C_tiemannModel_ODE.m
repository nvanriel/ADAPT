function dxdt = C_tiemannModel_ODE(t,x,p,u,m)


mwTG = m.c.mwTG;
mvTG = m.c.mvTG;
mwCE = m.c.mwCE;
mvCE = m.c.mvCE;
mwFC = m.c.mwFC;
mvFC = m.c.mvFC;
mwPL = m.c.mwPL;
mvPL = m.c.mvPL;
mwApoB = m.c.mwApoB;
navg = m.c.navg;
uH = m.c.uH;
plasma_volume = m.c.plasma_volume;
rs = m.c.rs;
npi = m.c.npi;

hep_FC = x(m.s.hep_FC);
hep_CE = x(m.s.hep_CE);
hep_CE_ER = x(m.s.hep_CE_ER);
hep_TG = x(m.s.hep_TG);
hep_TG_ER = x(m.s.hep_TG_ER);
hep_TG_DNL = x(m.s.hep_TG_DNL);
hep_TG_ER_DNL = x(m.s.hep_TG_ER_DNL);
plasma_TG = x(m.s.plasma_TG);
plasma_C = x(m.s.plasma_C);
plasma_C_HDL = x(m.s.plasma_C_HDL);
plasma_FFA = x(m.s.plasma_FFA);

Vm_FC_prod = p(m.p.Vm_FC_prod);
Vm_FC_met = p(m.p.Vm_FC_met);
Vm_CE_for = p(m.p.Vm_CE_for);
Vm_CE_def = p(m.p.Vm_CE_def);
Vm_CE_ER_for = p(m.p.Vm_CE_ER_for);
Vm_CE_ER_def = p(m.p.Vm_CE_ER_def);
Vm_TG_prod = p(m.p.Vm_TG_prod);
Vm_TG_met = p(m.p.Vm_TG_met);
Vm_TG_for = p(m.p.Vm_TG_for);
Vm_TG_ER_prod = p(m.p.Vm_TG_ER_prod);
Vm_TG_ER_for = p(m.p.Vm_TG_ER_for);
Vm_FFA_upt = p(m.p.Vm_FFA_upt);
Vm_FFA_prod = p(m.p.Vm_FFA_prod);
Vm_VLDL_TG = p(m.p.Vm_VLDL_TG);
Vm_VLDL_CE = p(m.p.Vm_VLDL_CE);
Vm_TG_CE_upt = p(m.p.Vm_TG_CE_upt);
Vm_TG_CE_upt_ph = p(m.p.Vm_TG_CE_upt_ph);
Vm_TG_hyd = p(m.p.Vm_TG_hyd);
Vm_TG_hyd_ph = p(m.p.Vm_TG_hyd_ph);
Vm_HDL_CE_for = p(m.p.Vm_HDL_CE_for);
Vm_HDL_CE_upt = p(m.p.Vm_HDL_CE_upt);
Vm_ApoB_prod = p(m.p.Vm_ApoB_prod);
Vm_TG_CE_upt_0 = p(m.p.Vm_TG_CE_upt_0);
Vm_TG_CE_upt_ph_0 = p(m.p.Vm_TG_CE_upt_ph_0);

J_FC_production = Vm_FC_prod;
J_FC_metabolism = Vm_FC_met * hep_FC;
J_CE_formation = Vm_CE_for * hep_FC;
J_CE_deformation = Vm_CE_def * hep_CE;
J_CE_ER_formation = Vm_CE_ER_for * hep_FC;
J_CE_ER_deformation = Vm_CE_ER_def * hep_CE_ER;
J_TG_production = Vm_TG_prod;
J_TG_metabolism = Vm_TG_met * hep_TG;
J_TG_metabolism_DNL = Vm_TG_met * hep_TG_DNL;
J_TG_formation = Vm_TG_for * hep_TG_ER;
J_TG_formation_DNL = Vm_TG_for * hep_TG_ER_DNL;
J_TG_ER_production = Vm_TG_ER_prod;
J_TG_ER_formation = Vm_TG_ER_for * hep_TG;
J_TG_ER_formation_DNL = Vm_TG_ER_for * hep_TG_DNL;
J_FFA_upt_1 = Vm_FFA_upt * plasma_FFA;
J_FFA_upt_2 = Vm_FFA_upt * plasma_FFA * plasma_volume;
J_FFA_prod = Vm_FFA_prod;
J_VLDL_TG_1 = Vm_VLDL_TG * hep_TG_ER;
J_VLDL_TG_DNL_1 = Vm_VLDL_TG * hep_TG_ER_DNL;
J_VLDL_CE_1 = Vm_VLDL_CE * hep_CE_ER;
J_VLDL_TG_2 = Vm_VLDL_TG * hep_TG_ER / plasma_volume;
J_VLDL_TG_DNL_2 = Vm_VLDL_TG * hep_TG_ER_DNL / plasma_volume;
J_VLDL_CE_2 = Vm_VLDL_CE * hep_CE_ER / plasma_volume;
J_TG_upt_1 = Vm_TG_CE_upt * plasma_TG;
J_CE_upt_1 = Vm_TG_CE_upt * plasma_C;
J_TG_upt_ph = Vm_TG_CE_upt_ph * plasma_TG;
J_CE_upt_ph = Vm_TG_CE_upt_ph * plasma_C;
J_CE_HDL_for = Vm_HDL_CE_for;
J_CE_HDL_upt_1 = Vm_HDL_CE_upt * plasma_C_HDL;
J_TG_hyd_1 = Vm_TG_hyd * plasma_TG;
J_TG_hyd_ph = Vm_TG_hyd_ph * plasma_TG;
J_TG_upt_2 = Vm_TG_CE_upt * plasma_TG * plasma_volume;
J_CE_upt_2 = Vm_TG_CE_upt * plasma_C * plasma_volume;
J_CE_HDL_upt_2 = Vm_HDL_CE_upt * plasma_C_HDL * plasma_volume;
J_TG_hyd_2 = Vm_TG_hyd * plasma_TG * plasma_volume;
J_VLDL_TG = Vm_VLDL_TG * (hep_TG_ER + hep_TG_ER_DNL);
J_VLDL_CE = Vm_VLDL_CE * hep_CE_ER;
J_ApoB_prod = Vm_ApoB_prod;
ApoB_count = J_ApoB_prod * navg * 10^23 * 10^-6;
TG_count = J_VLDL_TG * navg * 10^23 * 10^-6 / ApoB_count;
CE_count = J_VLDL_CE * navg * 10^23 * 10^-6 / ApoB_count;
DNL = (hep_TG_DNL + hep_TG_ER_DNL) / (hep_TG + hep_TG_ER + hep_TG_DNL + hep_TG_ER_DNL);
lipo_vc = ( (TG_count * mvTG) + (CE_count * mvCE) ) * (pow(10,21) / (navg * 10^23));
lipo_rc = pow((3 * lipo_vc) / (4 * npi), 1/3);
VLDL_diameter = (lipo_vc + lipo_rc) * 2;
VLDL_clearance = (Vm_TG_CE_upt + Vm_TG_CE_upt_ph) / (Vm_TG_CE_upt_0 + Vm_TG_CE_upt_ph_0);
J_CE_HDL_upt = Vm_HDL_CE_upt * plasma_C_HDL;
dhep_TG_abs = hep_TG + hep_TG_ER + hep_TG_DNL + hep_TG_ER_DNL;
dhep_CE_abs = hep_CE + hep_CE_ER;
dhep_FC_abs = hep_FC;
dplasma_C = plasma_C + plasma_C_HDL;
dplasma_TG = plasma_TG;
dVLDL_TG_C_ratio = TG_count / CE_count;
dVLDL_diameter = VLDL_diameter;
dVLDL_production = J_VLDL_TG;
dVLDL_clearance = VLDL_clearance;
dDNL = DNL;
dFFA = plasma_FFA;
dplasma_C_HDL = plasma_C_HDL;
dhep_HDL_CE_upt = J_CE_HDL_upt * plasma_volume;

dxdt(1) = J_FC_production - J_FC_metabolism - J_CE_formation + J_CE_deformation - J_CE_ER_formation + J_CE_ER_deformation;
dxdt(2) = J_CE_formation - J_CE_deformation + J_CE_upt_2 + J_CE_HDL_upt_2;
dxdt(3) = J_CE_ER_formation - J_CE_ER_deformation - J_VLDL_CE_1;
dxdt(4) = - J_TG_metabolism + J_TG_formation - J_TG_ER_formation + (J_FFA_upt_2/3.0) + J_TG_upt_2 + J_TG_hyd_2;
dxdt(5) = - J_TG_formation + J_TG_ER_formation - J_VLDL_TG_1;
dxdt(6) = J_TG_production - J_TG_metabolism_DNL + J_TG_formation_DNL - J_TG_ER_formation_DNL;
dxdt(7) = J_TG_ER_production - J_TG_formation_DNL + J_TG_ER_formation_DNL - J_VLDL_TG_DNL_1;
dxdt(8) = J_VLDL_TG_2 + J_VLDL_TG_DNL_2 - J_TG_upt_1 - J_TG_upt_ph - J_TG_hyd_1 - J_TG_hyd_ph;
dxdt(9) = J_VLDL_CE_2 - J_CE_upt_1 - J_CE_upt_ph;
dxdt(10) = J_CE_HDL_for - J_CE_HDL_upt_1;
dxdt(11) = J_FFA_prod - J_FFA_upt_1;

dxdt = dxdt(:);